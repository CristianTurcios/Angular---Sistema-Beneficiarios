<div class="header pb-8 pt-5 pt-lg-5 d-flex align-items-center">
  <!-- Mask -->
  <span class="mask bg-gradient-danger opacity-8"></span>
  <!-- Header container -->
  <div class="container-fluid d-flex align-items-center">
    <div class="row">
      <div class="col-lg-8 col-md-10">
        <h1 class="display-2 text-white">Sistema Beneficiarios: Persona con Discapacidad</h1>
      </div>
    </div>
  </div>
</div>

<div class="d-flex justify-content-center" *ngIf="loading">
  <div class="spinner-border" role="status">
    <span class="visually-hidden"></span>
  </div>
</div>

<div class="container-fluid mt--7" *ngIf="!loading">
  <div class="row">
    <div class="col-xl-12 order-xl-1">
      <div class="card bg-secondary shadow">
        <div class="card-header bg-white border-0">
          <div class="row align-items-center">
            <div class="col-8">
              <div class="alert alert-success" role="alert" *ngIf="success">
                <strong>Exito!</strong> Registro guardado con exito
              </div>
              <div class="alert alert-danger" role="alert" *ngIf="error">
                <strong>Error!</strong> {{errorMessage}}
              </div>
              <h3 class="mb-0">Registro</h3>
            </div>
          </div>
        </div>
        <div class="card-body">
          <form [formGroup]="form" (ngSubmit)="onSubmit()">
            <h6 class="heading-small text-muted mb-4">Información del beneficiario</h6>
            <div class="pl-lg-4">
              <div class="row">
                <div class="col-lg-6">
                  <div class="form-group">
                    <label class="form-control-label" for="input-username">Nombre</label>
                    <input maxlength="255" type="text" id="input-username" class="form-control form-control-alternative"
                      placeholder="Nombre" formControlName="name">
                  </div>
                </div>
                <div class="col-lg-6">
                  <div class="form-group">
                    <label class="form-control-label" for="input-last-name">Apellido</label>
                    <input maxlength="255" type="text" id="input-last-name"
                      class="form-control form-control-alternative" placeholder="Apellido" formControlName="lastName">
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="col-lg-6">
                  <div class="form-group">
                    <label class="form-control-label" for="input-username">No. Identidad</label>
                    <input maxlength="13" type="text" id="input-username" class="form-control form-control-alternative"
                      placeholder="000000000000" formControlName="identidad">
                  </div>
                  <p *ngIf="f.identidad.invalid && (f.identidad.touched || f.identidad.dirty) && f.identidad.value !== ''"
                    class="msg-error">
                    No se permiten letras
                  </p>
                  <p *ngIf="f.identidad.invalid && (f.identidad.touched || f.identidad.dirty) && f.identidad.value === '' || submitted && f.identidad.invalid"
                    class="msg-error">
                    * Requerido
                  </p>
                </div>
                <div class="col-lg-6">
                  <div class="form-group">
                    <label class="form-control-label" for="input-last-name">Telefono</label>
                    <input maxlength="8" type="text" id="input-last-name" class="form-control form-control-alternative"
                      placeholder="00000000" formControlName="phone">
                  </div>
                  <p *ngIf="f.phone.invalid && (f.phone.touched || f.phone.dirty) && f.phone.value !== ''"
                    class="msg-error">
                    No se permiten letras
                  </p>
                  <p *ngIf="f.phone.invalid && (f.phone.touched || f.phone.dirty) && f.phone.value === '' || submitted && f.phone.invalid"
                    class="msg-error">
                    * Requerido
                  </p>
                </div>
              </div>
              <div class="row">
                <div class="col-lg-6">
                  <!--  -->
                  <div class="form-group">
                    <label class="form-control-label" for="input-date">Fecha de Nacimiento</label>
                    <div class="input-group input-group-alternative">
                      <div class="input-group-prepend">
                        <span class="input-group-text"><i class="ni ni-calendar-grid-58"></i></span>
                      </div>
                      <input class="form-control form-control-alternative" placeholder="Selecciona una fecha" name="dp"
                        [(ngModel)]="model" ngbDatepicker #d="ngbDatepicker" (click)="d.toggle()" type="text"
                        formControlName="bornDate" [minDate]="{year: 1910, month: 1, day: 1}"
                         />
                    </div>
                  </div>
                  <p *ngIf="f.bornDate.invalid && (f.bornDate.touched || f.bornDate.dirty) && f.bornDate.value === '' || submitted && f.bornDate.invalid"
                    class="msg-error">
                    * Requerido
                  </p>
                  <p *ngIf="isInvalidYear" class="msg-error">
                    * Fecha no permitida
                  </p>
                </div>
                <div class="col-lg-6">
                  <div class="form-group">
                    <label class="form-control-label" for="input-discapacidad">Discapacidad</label>
                    <input id="input-discapacidad" class="form-control form-control-alternative" type="text"
                      placeholder="Discapacidad" formControlName="discapacidad">
                    <p *ngIf="f.discapacidad.invalid && (f.discapacidad.touched || f.discapacidad.dirty) && f.discapacidad.value === '' || submitted && f.discapacidad.invalid"
                      class="msg-error">
                      * Requerido
                    </p>
                  </div>
                </div>
                <!--  -->
              </div>
              <div class="row">
                <div class="col-md-6">
                  <div class="form-group">
                    <label class="form-control-label" for="input-address">Sexo</label>
                    <select formControlName="sex" id="input-sex" class="form-control form-control-alternative">
                      <option value="" selected disabled hidden>Sexo</option>
                      <option value="Femenino">Femenino</option>
                      <option value="Masculino">Masculino</option>
                      <option value="Otros">Otros</option>
                    </select>
                    <p *ngIf="f.sex.invalid && (f.sex.touched || f.sex.dirty) && f.sex.value === '' || submitted && f.sex.invalid"
                      class="msg-error">
                      * Requerido
                    </p>
                  </div>
                </div>
              </div>
            </div>
            <hr class="my-4" />

            <!-- Persona a cargo -->
            <h6 class="heading-small text-muted mb-4">Información Persona a cargo (Opcional)</h6>
            <div class="pl-lg-4">
              <div class="row">
                <div class="col-lg-6">
                  <div class="form-group">
                    <label class="form-control-label" for="input-username">Nombre Completo</label>
                    <input maxlength="255" type="text" id="input-username" class="form-control form-control-alternative"
                      placeholder="Nombre Completo" formControlName="fullNamePersonInCharge">
                  </div>
                </div>
                <div class="col-lg-6">
                  <div class="form-group">
                    <label class="form-control-label" for="input-username">No. Identidad</label>
                    <input maxlength="13" type="text" id="input-username" class="form-control form-control-alternative"
                      placeholder="000000000000" formControlName="identidadPersonInCharge">
                  </div>
                  <p *ngIf="f.identidadPersonInCharge.invalid && (f.identidadPersonInCharge.touched || f.identidadPersonInCharge.dirty) && f.identidadPersonInCharge.value !== ''"
                    class="msg-error">
                    No se permiten letras
                  </p>
                  <!-- <p *ngIf="f.identidad.invalid && (f.identidad.touched || f.identidad.dirty) && f.identidad.value === '' || submitted && f.identidad.invalid"
                    class="msg-error">
                    * Requerido
                  </p> -->
                </div>
              </div>
              <div class="row">
                <div class="col-lg-6">
                  <div class="form-group">
                    <label class="form-control-label" for="input-last-name">Telefono</label>
                    <input maxlength="8" type="text" id="input-last-name" class="form-control form-control-alternative"
                      placeholder="00000000" formControlName="phonePersonInCharge">
                  </div>
                  <p *ngIf="f.phonePersonInCharge.invalid && (f.phonePersonInCharge.touched || f.phonePersonInCharge.dirty) && f.phonePersonInCharge.value !== ''"
                    class="msg-error">
                    No se permiten letras
                  </p>
                  <!-- <p *ngIf="f.phone.invalid && (f.phone.touched || f.phone.dirty) && f.phone.value === '' || submitted && f.phone.invalid"
                    class="msg-error">
                    * Requerido
                  </p> -->
                </div>
                <div class="col-lg-6">
                  <!--  -->
                  <div class="form-group">
                    <label class="form-control-label" for="input-date">Fecha de Nacimiento</label>
                    <div class="input-group input-group-alternative">
                      <div class="input-group-prepend">
                        <span class="input-group-text"><i class="ni ni-calendar-grid-58"></i></span>
                      </div>
                      <input class="form-control form-control-alternative" placeholder="Selecciona una fecha" name="dp1"
                        [(ngModel)]="model1" ngbDatepicker #d1="ngbDatepicker" (click)="d1.toggle()" type="text" formControlName="bornDatePersonInCharge"
                        [minDate]="{year: 1910, month: 1, day: 1}" [maxDate]="{year: supportedYear, month: 12, day: 31}" />
                    </div>
                  </div>
                  <!-- <p *ngIf="f.bornDate.invalid && (f.bornDate.touched || f.bornDate.dirty) && f.bornDate.value === '' || submitted && f.bornDate.invalid"
                    class="msg-error">
                    * Requerido
                  </p> -->
                  <p *ngIf="isInvalidYear" class="msg-error">
                    * Fecha no permitida
                  </p>
                </div>
              </div>
            </div>

            <!-- Address -->
            <h6 class="heading-small text-muted mb-4">Dirección</h6>
            <div class="pl-lg-4">
              <div class="row">
                <div class="col-md-6">
                  <div class="form-group">
                    <label class="form-control-label" for="input-address">Departamento</label>
                    <select formControlName="department" id="input-departmento"
                      class="form-control form-control-alternative">
                      <option value="" selected disabled hidden>Departamento</option>
                      <option *ngFor="let state of states; let i = index" [value]="state.state_name">
                        {{state.state_name}}
                      </option>
                    </select>
                    <p *ngIf="f.department.invalid && (f.department.touched || f.department.dirty) && f.department.value === '' || submitted && f.department.invalid"
                      class="msg-error">
                      * Requerido
                    </p>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="form-group">
                    <label class="form-control-label" for="input-address">Municipio</label>
                    <input id="input-municipality" class="form-control form-control-alternative" type="text"
                      formControlName="municipality">
                    <p *ngIf="f.municipality.invalid && (f.municipality.touched || f.municipality.dirty) && f.municipality.value === '' || submitted && f.municipality.invalid"
                      class="msg-error">
                      * Requerido
                    </p>
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="col-md-6">
                  <div class="form-group">
                    <label class="form-control-label" for="input-address">Aldea</label>
                    <input id="input-aldea" class="form-control form-control-alternative" type="text"
                      formControlName="village">
                    <p *ngIf="f.village.invalid && (f.village.touched || f.village.dirty) && f.village.value === '' || submitted && f.village.invalid"
                      class="msg-error">
                      * Requerido
                    </p>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="form-group">
                    <label class="form-control-label" for="input-city">Barrio</label>
                    <input type="text" id="input-barrio" class="form-control form-control-alternative"
                      formControlName="barrio">
                    <p *ngIf="f.barrio.invalid && (f.barrio.touched || f.barrio.dirty) && f.barrio.value === '' || submitted && f.barrio.invalid"
                      class="msg-error">
                      * Requerido
                    </p>
                  </div>
                </div>
              </div>
            </div>
            <hr class="my-4" />
            <div class="text-right">
              <button type="submit" class="btn btn-primary my-4" [disabled]="loading">Guardar</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>